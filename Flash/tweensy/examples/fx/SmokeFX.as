package {	import flash.display.*;	import flash.events.*;	import flash.filters.BlurFilter;	import flash.geom.ColorTransform;	import flash.utils.getDefinitionByName;		import com.flashdynamix.motion.TweensyGroup;	import com.flashdynamix.motion.effects.*;	import com.flashdynamix.motion.effects.core.*;	import com.flashdynamix.motion.extras.Emitter;	import com.flashdynamix.motion.layers.*;	import com.flashdynamix.utils.SWFProfiler;		/**	 * @author shanem	 */	public class SmokeFX extends Sprite {		private var tween : TweensyGroup;		private var smokeEmittor : Emitter;		private var layer : BitmapLayer;		private var smokeStartCt : ColorTransform;		private var smokeEndCt : ColorTransform;		private var disp : PerlinDisplacementEffect;		private var tx : Number;		private var ty : Number;		public function SmokeFX() {			SWFProfiler.init(this);						tween = new TweensyGroup(false, true);			layer = new BitmapLayer(550, 400, 2);						disp = new PerlinDisplacementEffect(275, 200, 2, -4, 2);			disp.baseX = 50;			disp.baseY = 40;						layer.add(disp);			layer.add(new FilterEffect(new BlurFilter(3, 3, 1)));			layer.add(new ColorEffect(new ColorTransform(1, 1, 1, 0.95)));						smokeStartCt = new ColorTransform(0.45, 0.25, 0.075, 1, 255, 38, 134, -50);			smokeEndCt = new ColorTransform(0.5, 0.75, 0.375, 1, -96, -255, 45, -200);						stage.quality = StageQuality.LOW;						var Smoke : Class = getDefinitionByName("Smoke") as Class;						smokeEmittor = new Emitter(Smoke, {scaleX:2.5, scaleY:2.5, rotation:"-180,180"}, 1, 1, "255, 285", "100, 240", 1, BlendMode.NORMAL);			smokeEmittor.transform.colorTransform = smokeStartCt;			smokeEmittor.endColor = smokeEndCt;			smokeEmittor.scale = 0.1;						layer.draw(smokeEmittor.holder);						tx = 250;			ty = 350;						addChildAt(layer, 0);						addEvent(stage, Event.ENTER_FRAME, draw);			addEvent(stage, MouseEvent.MOUSE_MOVE, move);		}				private function move(e : MouseEvent) : void {			tx = stage.mouseX;			ty = stage.mouseY;		}		private function draw(e : Event) : void {			smokeEmittor.x += (tx - smokeEmittor.x) / 4;			smokeEmittor.y += (ty - smokeEmittor.y) / 4;		}		protected function addEvent(item : EventDispatcher, type : String, liststener : Function, priority : int = 0, useWeakReference : Boolean = true) : void {			item.addEventListener(type, liststener, false, priority, useWeakReference);		}		protected function removeEvent(item : EventDispatcher, type : String, listener : Function) : void {			item.removeEventListener(type, listener);		}	}}